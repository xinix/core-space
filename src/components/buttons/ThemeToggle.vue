<script lang="ts" setup>
import { useTheme } from '@/stores/theme'

const theme = useTheme()
theme.apply()

const onToggleDark = (ev: MouseEvent) => {
    theme.toggle()
    theme.save()
    theme.apply()
    return ev
}
</script>

<template>
    <button
        :class="{ dark: theme.dark }"
        class="btn theme-toggle"
        type="button"
        @click="onToggleDark"
    >
        <svg
            :height="0.45 * 86"
            :width="0.45 * 183"
            fill="none"
            viewBox="0 0 183 86"
            xmlns="http://www.w3.org/2000/svg"
        >
            <rect id="bg" fill="#293C33" height="86" rx="43" width="183" />
            <circle id="main-circle" cx="44" cy="43" fill="#fff" r="24" />
            <mask
                id="a"
                height="48"
                maskUnits="userSpaceOnUse"
                style="mask-type: alpha"
                width="48"
                x="20"
                y="19"
            >
                <circle cx="44" cy="43" fill="#fff" r="24" />
            </mask>
            <g id="moon-dots" fill="#899390" fill-opacity=".25" mask="url(#a)">
                <circle cx="43" cy="34" r="5" />
                <circle cx="50.5" cy="56.5" r="2.5" />
                <circle cx="29.5" cy="26.5" r="6.5" />
                <circle cx="29.5" cy="55.5" r="9.5" />
                <circle cx="65" cy="41" r="12" />
            </g>

            <path
                id="stars"
                d="m97.0051 23.0026 1.5854 3.8163 4.1195.332-3.1399 2.6871.9569 4.0202-3.5256-2.1556-3.5276 2.1526.9606-4.0194-3.1374-2.6898 4.1195-.3285 1.5886-3.8149ZM111.504 50.004l2.51 6.0403 6.519.5254-4.969 4.253 1.515 6.3628-5.58-3.4117-5.584 3.407 1.521-6.3616-4.966-4.2572 6.52-.5199 2.514-6.0381ZM148.503 44.0023l1.453 3.4975 3.775.3043-2.877 2.4626.877 3.6842-3.231-1.9755-3.233 1.9728.88-3.6835-2.875-2.4651 3.775-.301 1.456-3.4963ZM140.503 25.0015l.925 2.2263 2.403.1937-1.832 1.5675.559 2.3453-2.057-1.2575-2.058 1.2557.56-2.3447-1.83-1.5692 2.403-.1916.927-2.2255Z"
                fill="#fff"
            />

            <g id="clouds" fill="#fff">
                <path
                    d="M95 29c0 2.2091-1.7909 4-4 4-2.2091 0-4-1.7909-4-4 0-2.2091 1.7909-4 4-4 2.2091 0 4 1.7909 4 4Z"
                />
                <path
                    d="M106 27.5c0 3.5899-2.91 6.5-6.5 6.5-3.5899 0-6.5-2.9101-6.5-6.5s2.9101-6.5 6.5-6.5c3.59 0 6.5 2.9101 6.5 6.5Z"
                />
                <path
                    d="M110 32.5c0 3.0376-2.462 5.5-5.5 5.5S99 35.5376 99 32.5s2.462-5.5 5.5-5.5 5.5 2.4624 5.5 5.5Z"
                />
                <path
                    d="M84 33c0-2.2091 1.7909-4 4-4h16c2.209 0 4 1.7909 4 4v1c0 2.2091-1.791 4-4 4H88c-2.2091 0-4-1.7909-4-4v-1ZM145 58c0 2.2091-1.791 4-4 4s-4-1.7909-4-4c0-2.2091 1.791-4 4-4s4 1.7909 4 4Z"
                />
                <path
                    d="M156 56.5c0 3.5899-2.91 6.5-6.5 6.5s-6.5-2.9101-6.5-6.5 2.91-6.5 6.5-6.5 6.5 2.9101 6.5 6.5Z"
                />
                <path
                    d="M160 61.5c0 3.0376-2.462 5.5-5.5 5.5s-5.5-2.4624-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.4624 5.5 5.5Z"
                />
                <path
                    d="M134 62c0-2.2091 1.791-4 4-4h16c2.209 0 4 1.7909 4 4v1c0 2.2091-1.791 4-4 4h-16c-2.209 0-4-1.7909-4-4v-1ZM132.808 23.1765c0 1.4294 1.171 2.5882 2.615 2.5882 1.445 0 2.615-1.1588 2.615-2.5882 0-1.4295-1.17-2.5883-2.615-2.5883-1.444 0-2.615 1.1588-2.615 2.5883Z"
                />
                <path
                    d="M125.615 22.2059c0 2.3228 1.903 4.2059 4.25 4.2059 2.348 0 4.25-1.8831 4.25-4.2059 0-2.3229-1.902-4.2059-4.25-4.2059-2.347 0-4.25 1.883-4.25 4.2059Z"
                />
                <path
                    d="M123 25.4412C123 27.4067 124.61 29 126.596 29s3.596-1.5933 3.596-3.5588c0-1.9655-1.61-3.5588-3.596-3.5588S123 23.4757 123 25.4412Z"
                />
                <path
                    d="M140 25.7647c0-1.4294-1.171-2.5882-2.615-2.5882h-10.462c-1.444 0-2.615 1.1588-2.615 2.5882v.6471c0 1.4294 1.171 2.5882 2.615 2.5882h10.462c1.444 0 2.615-1.1588 2.615-2.5882v-.6471ZM114.423 57.5294c0 2.0792 1.722 3.7647 3.846 3.7647s3.846-1.6855 3.846-3.7647-1.722-3.7647-3.846-3.7647-3.846 1.6855-3.846 3.7647Z"
                />
                <path
                    d="M103.846 56.1176c0 3.3787 2.798 6.1177 6.25 6.1177s6.25-2.739 6.25-6.1177c0-3.3786-2.798-6.1176-6.25-6.1176s-6.25 2.739-6.25 6.1176Z"
                />
                <path
                    d="M100 60.8235C100 63.6824 102.368 66 105.288 66c2.921 0 5.289-2.3176 5.289-5.1765 0-2.8589-2.368-5.1764-5.289-5.1764-2.92 0-5.288 2.3175-5.288 5.1764Z"
                />
                <path
                    d="M125 61.2941c0-2.0792-1.722-3.7647-3.846-3.7647h-15.385c-2.124 0-3.846 1.6855-3.846 3.7647v.9412c0 2.0792 1.722 3.7647 3.846 3.7647h15.385c2.124 0 3.846-1.6855 3.846-3.7647v-.9412ZM97.0051 23.0026l1.5854 3.8163 4.1195.332-3.1399 2.6871.9569 4.0202-3.5256-2.1556-3.5276 2.1526.9606-4.0194-3.1374-2.6898 4.1195-.3285 1.5886-3.8149Z"
                />
            </g>
        </svg>

        <path
            d="m97.0051 23.0026 1.5854 3.8163 4.1195.332-3.1399 2.6871.9569 4.0202-3.5256-2.1556-3.5276 2.1526.9606-4.0194-3.1374-2.6898 4.1195-.3285 1.5886-3.8149ZM111.504 50.004l2.51 6.0403 6.519.5254-4.969 4.253 1.515 6.3628-5.58-3.4117-5.584 3.407 1.521-6.3616-4.966-4.2572 6.52-.5199 2.514-6.0381ZM148.503 44.0023l1.453 3.4975 3.775.3043-2.877 2.4626.877 3.6842-3.231-1.9755-3.233 1.9728.88-3.6835-2.875-2.4651 3.775-.301 1.456-3.4963ZM140.503 25.0015l.925 2.2263 2.403.1937-1.832 1.5675.559 2.3453-2.057-1.2575-2.058 1.2557.56-2.3447-1.83-1.5692 2.403-.1916.927-2.2255Z"
            fill="#fff"
        />
    </button>
</template>

<style lang="scss" scoped>
$light-bg: #9abbc0;

#bg,
#stars,
#clouds,
#main-circle,
#moon-dots {
    transition: all 0.3s ease-out;
}

.theme-toggle {
    margin: 0 1em;
    background-color: transparent;

    &:active,
    &:hover {
        transform: scale(1);
    }

    /* BACKGROUND */
    &:not(.dark) svg #bg {
        fill: $light-bg;
    }

    /* SUN */
    &:not(.dark) svg #main-circle {
        transform: translateX(100px);
        fill: #fee253;
    }

    /* HIDE MOON ACCENTS */
    &:not(.dark) svg #moon-dots {
        transform: translateX(100px);
        opacity: 0;
    }

    /* HIDE STARS */
    &:not(.dark) svg #stars {
        transform: translateX(50px);
        opacity: 0;
    }

    /* HIDE CLOUDS */
    &.dark svg #clouds {
        transform: translateX(0px);
        opacity: 0;
    }

    &:not(.dark) svg #clouds {
        transform: translateX(-50px);
    }
}
</style>
